# ATT-004: Fix Task Directory Structure - Single Root Directory Implementation

**Project**: ai-trackdown-tools  
**Priority**: CRITICAL  
**Story Points**: 13  
**Epic**: AI-Trackdown Compliance Architecture  
**Status**: ğŸš¨ CRITICAL BUG - READY FOR DEVELOPMENT  
**Created**: 2025-07-08  
**Assignee**: Engineer Agent (TBD)

## ğŸ¯ OBJECTIVE

Fix the incorrect task directory structure implementation. Currently, the CLI creates separate root-level directories for each task type (epics/, issues/, tasks/, prs/), but per AI-Trackdown specification, all task types should be organized under a single configurable top-level directory (default: tasks/).

## ğŸ› BUG DESCRIPTION

**Current Incorrect Behavior:**
```
project-root/
â”œâ”€â”€ epics/           # âŒ Wrong - separate root directory
â”œâ”€â”€ issues/          # âŒ Wrong - separate root directory  
â”œâ”€â”€ tasks/           # âŒ Wrong - separate root directory
â”œâ”€â”€ prs/             # âŒ Wrong - separate root directory
â””â”€â”€ ...
```

**Expected Correct Behavior:**
```
project-root/
â”œâ”€â”€ tasks/           # âœ… Correct - single configurable root
â”‚   â”œâ”€â”€ epics/
â”‚   â”œâ”€â”€ issues/
â”‚   â”œâ”€â”€ tasks/
â”‚   â”œâ”€â”€ prs/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

## ğŸ“‹ SCOPE

**Phase 1: Configuration System (5 Story Points)**
- Add `tasksDirectory` configuration option (default: "tasks")
- Update configuration schema and validation
- Ensure backward compatibility with existing projects
- Update help documentation for new configuration

**Phase 2: Directory Structure Refactor (5 Story Points)**
- Update all command implementations to use unified directory structure
- Modify file creation logic to use `{tasksDirectory}/{type}/` pattern
- Update template generation to reflect correct structure
- Fix path resolution throughout the codebase

**Phase 3: Migration and Testing (3 Story Points)**
- Create migration utility for existing projects with incorrect structure
- Add comprehensive tests for new directory structure
- Update examples and documentation
- Verify all commands work with new structure

## ğŸ”§ TECHNICAL REQUIREMENTS

**Configuration Changes:**
- Add `tasksDirectory` field to project configuration
- Default value: "tasks"
- Must be configurable via CLI `--tasks-dir` option
- Must be configurable via config file

**Code Changes Required:**
- Update path resolution in all command files
- Modify template generation logic
- Update file discovery and listing functions
- Fix any hardcoded directory references

**Files Requiring Updates:**
- Configuration schema and validation
- All command implementations (epic, issue, task, pr)
- Template generation utilities
- Path resolution utilities
- Documentation and help text

## âœ… ACCEPTANCE CRITERIA

1. **Single Root Directory:** All task types created under configurable root directory
2. **Default Configuration:** Uses "tasks/" as default root directory name
3. **Configurable:** Directory name configurable via CLI option and config file
4. **Backward Compatibility:** Existing projects continue to work or have migration path
5. **Consistent Structure:** All commands create files in correct subdirectories
6. **Documentation Updated:** Help text and examples reflect correct structure
7. **Tests Pass:** All existing tests updated and new tests added

## ğŸš¨ IMPACT ASSESSMENT

**Breaking Change:** Yes - affects file organization
**User Impact:** High - changes expected project structure
**Migration Required:** Yes - for projects using incorrect structure
**Priority Justification:** Critical compliance issue with AI-Trackdown specification

## ğŸ”— RELATED TICKETS

- ATT-002: Configurable Issue Documents Root Directory (partial implementation)
- ATT-003: Complete Redesign for ai-trackdown Compliance (architecture requirements)

## ğŸ“ NOTES

This is a critical architectural compliance issue that must be resolved before the package can be considered production-ready. The current implementation violates the AI-Trackdown specification and creates confusion about proper project organization.

---

*Generated by ai-trackdown-tools CLI on 2025-07-08*